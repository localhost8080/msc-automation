#!/usr/bin/env python
from jonathans_scanner import jonathans_scanner

def main():

	name = 'arachni'

	scanner = jonathans_scanner(name)

	for url in scanner.dvwa_urls:
		print url
		scanner.setUrls(url)

		cmd = ['/usr/bin/arachni', '--checks', 'sql_injection,no_sql_injection,sql_injection_timing,sql_injection_differential,no_sql_injection_differential', '--output-only-positives', '--report-save-path', scanner.reports + '.afr', '--http-cookie-string', '"security=low; PHPSESSID='+scanner.dvwa_session_id + '"', '--scope-page-limit','1', '"'+url+'"']
		cmd = ' '.join(cmd)

		test = scanner.begin(cmd)

	for url in scanner.wp15_urls:
		print url
		scanner.setUrls(url)

		cmd = ['/usr/bin/arachni', '--checks', 'sql_injection,no_sql_injection,sql_injection_timing,sql_injection_differential,no_sql_injection_differential', '--output-only-positives', '--report-save-path', scanner.reports + '.afr', '--http-cookie-string', scanner.wp15_session_id, '--scope-page-limit','1', '"'+url+'"']
		cmd = ' '.join(cmd)

		test = scanner.begin(cmd)

if __name__ == '__main__':
	main()
